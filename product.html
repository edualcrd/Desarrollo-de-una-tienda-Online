<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="product-title">Ficha de Producto | Tienda Online</title>
    <link rel="stylesheet" href="/Desarrollo-de-una-tienda-Online/assets/css/style.css">
</head>
<body>
    <header>
        <h1>üîç Ficha de Producto</h1>
        <nav>
            <a href="/Desarrollo-de-una-tienda-Online/dashboard.html">Dashboard</a> | 
            <a href="/Desarrollo-de-una-tienda-Online/categories.html">Categor√≠as</a> | 
            <a href="/Desarrollo-de-una-tienda-Online/cart.html">Carrito</a> | 
            <button id="logout-btn">Cerrar Sesi√≥n</button>
        </nav>
    </header>
    <main id="product-detail">
        </main>
    <script type="module" src="/Desarrollo-de-una-tienda-Online/assets/js/store.js"></script>
    <script type="module" src="/Desarrollo-de-una-tienda-Online/assets/js/main.js"></script>
    <script type="module">
        import { getProductById, addToCart, addRecentView } from '/Desarrollo-de-una-tienda-Online/assets/js/store.js';

        window.addToCart = addToCart; // Hacer addToCart global
        
        const detailContainer = document.getElementById('product-detail');
        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get('id');

        if (!productId) {
            detailContainer.innerHTML = '<p>Error: ID de producto no especificado.</p>';
        } else {
            // Obtener producto desde LocalStorage [cite: 84, 85]
            const product = getProductById(productId);

            if (product) {
                // Almacenar en LocalStorage como "visto recientemente" [cite: 94]
                addRecentView(product.id); 

                document.getElementById('product-title').textContent = product.nombre + ' | Tienda Online';
                
                detailContainer.innerHTML = `
                    <div class="product-ficha">
                        <img src="assets/images/${product.imagen}" alt="${product.nombre}" class="ficha-image">
                        <div>
                            <h2>${product.nombre}</h2>
                            <p class="ficha-price">${product.precio}‚Ç¨</p>
                            <p>Categor√≠a ID: ${product.id_categoria}</p>
                            <p>Descripci√≥n: Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
                            <input type="number" id="product-quantity" value="1" min="1" style="width: 50px; margin-right: 10px;">
                            <button id="add-to-cart-btn">A√±adir al Carrito [cite: 86]</button>
                        </div>
                    </div>
                `;
                
                document.getElementById('add-to-cart-btn').addEventListener('click', () => {
                    const quantity = parseInt(document.getElementById('product-quantity').value) || 1;
                    addToCart(product, quantity);
                });

            } else {
                detailContainer.innerHTML = '<p>Producto no encontrado en la tienda.</p>';
            }
        }
    </script>
</body>
</html>